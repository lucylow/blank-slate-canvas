# Lovable Cloud Deployment Configuration
# See https://docs.lovable.app for details

name: pitwall-backend
type: backend

build:
  dockerfile: Dockerfile
  context: .

run:
  command: ./start.sh
  port: 8000

environment:
  # Required
  - PORT=8000
  # Optional - set in Lovable UI
  - DEMO_MODE=true
  - DATA_ARCHIVE_URL=file:///mnt/data/pitwall-backend-v2.tar.gz
  # CORS: Allow all Lovable Cloud domains and localhost for development
  - ALLOWED_ORIGINS=https://*.lovable.app,http://localhost:5173,http://localhost:3000
  - SSE_INTERVAL_MS=1000
  - LOG_LEVEL=INFO
  
  # Redis (optional, but recommended for AI agents)
  # Note: In Lovable Cloud, Redis may be provided as a managed service
  # Update REDIS_URL in Lovable Cloud UI if using managed Redis
  - USE_REDIS_PUBSUB=false
  - REDIS_URL=redis://localhost:6379
  # AI Agents configuration
  - AI_AGENTS_ENABLED=true
  - AI_AGENTS_REDIS_URL=redis://localhost:6379
  
  # Model paths (optional)
  - AE_MODEL_PATH=
  - AE_THRESHOLD=0.0005

healthcheck:
  path: /health
  interval: 30s
  timeout: 5s
  retries: 3

readiness:
  path: /ready
  interval: 10s
  timeout: 3s
  retries: 2


